# üì± W√§ Estudio - Documentaci√≥n Completa de la Aplicaci√≥n

## üéØ **Descripci√≥n General**
**W√§ Estudio** es una aplicaci√≥n m√≥vil Flutter para gesti√≥n de negocios de servicios (spas, centros de belleza, consultorios, etc.). La app permite gestionar clientes, empleados, servicios y citas de forma profesional con autenticaci√≥n multi-usuario, almacenamiento en la nube, y sistema avanzado de clasificaci√≥n de clientes.

---

## ‚≠ê **Caracter√≠sticas Principales v2.1**

### üîê **Sistema de Autenticaci√≥n Multi-Usuario**
- Login seguro con email/contrase√±a
- Registro de nuevos usuarios
- Separaci√≥n completa de datos por usuario
- Persistencia de sesi√≥n

### üë• **Gesti√≥n Avanzada de Clientes**
- CRUD completo de clientes
- B√∫squeda en tiempo real
- Sistema de clasificaci√≥n por estrellas (0-3 niveles)
- Notificaciones autom√°ticas de cumplea√±os
- Sistema de papelera con restauraci√≥n
- Fotos de perfil con carga local

### üìÖ **Sistema de Citas**
- Agendar citas con cliente, servicio y terapeuta
- Calendario visual por fechas
- Estados de cita (Pendiente, Confirmada, Completada, Cancelada)
- Filtros por estado

### üè¢ **Gesti√≥n de Equipo**
- Administraci√≥n de terapeutas/empleados
- Asignaci√≥n de servicios por terapeuta
- CRUD completo de servicios del negocio

### üé® **Caracter√≠sticas Visuales Avanzadas**
- Splash screen animado con logo "W√§ Estudio"
- Tema Material Design 3 consistente
- Animaciones fluidas y profesionales
- Interfaz adaptativa y responsive

---

## üèóÔ∏è **Arquitectura T√©cnica**

### **Frontend**
- **Framework:** Flutter (Dart)
- **UI:** Material Design 3
- **Estado:** StatefulWidget con setState
- **Navegaci√≥n:** Navigator.push/pop est√°ndar

### **Backend**
- **Base de datos:** Firebase Firestore (NoSQL)
- **Autenticaci√≥n:** Firebase Authentication
- **Almacenamiento:** Local (para fotos) + Firebase Storage (preparado)
- **Configuraci√≥n:** firebase_options.dart auto-generado

### **Dependencias Principales**
```yaml
dependencies:
  flutter: sdk: flutter
  cupertino_icons: ^1.0.8
  cloud_firestore: ^4.17.5
  firebase_core: ^2.32.0
  firebase_auth: ^4.16.0
  firebase_storage: ^11.2.6
  shared_preferences: ^2.2.2
  image_picker: ^1.0.4
  intl: ^0.18.1
```

---

## üóÇÔ∏è **Estructura del Proyecto**

```
lib/
‚îú‚îÄ‚îÄ main.dart                 # Punto de entrada, configuraci√≥n del tema
‚îú‚îÄ‚îÄ firebase_options.dart     # Configuraci√≥n de Firebase
‚îú‚îÄ‚îÄ models/                   # Modelos de datos
‚îÇ   ‚îú‚îÄ‚îÄ cliente.dart         # Modelo Cliente con nivelCliente
‚îÇ   ‚îú‚îÄ‚îÄ cita.dart           # Modelo Cita
‚îÇ   ‚îî‚îÄ‚îÄ servicio.dart       # Modelo Servicio
‚îú‚îÄ‚îÄ services/               # Servicios y l√≥gica de negocio
‚îÇ   ‚îú‚îÄ‚îÄ auth_service.dart   # Servicio de autenticaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ birthday_service.dart # Servicio de cumplea√±os
‚îÇ   ‚îî‚îÄ‚îÄ papelera_service.dart # Servicio de papelera
‚îî‚îÄ‚îÄ screens/               # Pantallas de la aplicaci√≥n
    ‚îú‚îÄ‚îÄ splash_screen.dart
    ‚îú‚îÄ‚îÄ pantalla_inicio.dart
    ‚îú‚îÄ‚îÄ pantalla_login.dart
    ‚îú‚îÄ‚îÄ pantalla_registro.dart
    ‚îú‚îÄ‚îÄ pantalla_menu_terapeuta.dart
    ‚îú‚îÄ‚îÄ pantalla_agregar_cliente.dart
    ‚îú‚îÄ‚îÄ pantalla_ver_clientes.dart
    ‚îú‚îÄ‚îÄ pantalla_editar_cliente.dart
    ‚îú‚îÄ‚îÄ pantalla_agendar_cita.dart
    ‚îú‚îÄ‚îÄ pantalla_ver_citas.dart
    ‚îú‚îÄ‚îÄ pantalla_gestionar_terapeutas.dart
    ‚îî‚îÄ‚îÄ pantalla_gestionar_servicios.dart
```

---

## üé® **Dise√±o y Tema**

### **Colores Corporativos**
```dart
primaryColor: Color(0xFF008080)        // Teal principal
secondary: Color(0xFF20B2AA)           // Light Sea Green
surface: Color(0xFFA0D4D4)             // Light Cyan
scaffoldBackground: Color(0xFFFFFFFF)  // Blanco
```

### **Caracter√≠sticas Visuales**
- Material Design 3 con esquema de colores personalizado
- Iconograf√≠a coherente con Icons de Material
- Cards con elevaci√≥n sutil
- Botones con colores corporativos
- AppBars con t√≠tulo centrado y fondo corporativo

---

## üîê **Sistema de Autenticaci√≥n**

### **Servicio de Autenticaci√≥n (auth_service.dart)**
```dart
class AuthService {
  static final FirebaseAuth _auth = FirebaseAuth.instance;
  
  // Funcionalidades:
  - getCurrentUser() -> User?
  - signInWithEmailAndPassword()
  - createUserWithEmailAndPassword()  
  - signOut()
  - sendPasswordResetEmail()
  - Persistencia autom√°tica con SharedPreferences
}
```

### **Flujo de Autenticaci√≥n**
1. **SplashScreen** ‚Üí Verifica credenciales guardadas
2. **PantallaInicio** ‚Üí Opciones de login/registro
3. **PantallaLogin** ‚Üí Formulario de ingreso
4. **PantallaRegistro** ‚Üí Formulario de registro
5. **PantallaMenuTerapeuta** ‚Üí Men√∫ principal (autenticado)

---

## üíæ **Estructura de Base de Datos (Firestore)**

### **Colecci√≥n: `clientes`**
```javascript
{
  id: "doc_id_auto",
  nombre: "string",
  telefono: "string", 
  email: "string",
  fechaCumpleanos: "string (dd/mm/yyyy)",
  terapeutaUid: "string", // ID del usuario propietario
  fechaCreacion: Timestamp,
  activo: boolean,
  fotoPath: "string?" // Ruta local de la foto
}
```

### **Colecci√≥n: `terapeutas`**
```javascript
{
  id: "doc_id_auto",
  nombre: "string",
  estudioUid: "string", // ID del usuario propietario
  fechaCreacion: Timestamp,
  activo: boolean
}
```

### **Colecci√≥n: `servicios`**
```javascript
{
  id: "doc_id_auto", 
  nombre: "string",
  estudioUid: "string", // ID del usuario propietario
  fechaCreacion: Timestamp,
  activo: boolean
}
```

### **Colecci√≥n: `citas`**
```javascript
{
  id: "doc_id_auto",
  clienteNombre: "string",
  clienteTelefono: "string",
  terapeutaNombre: "string", 
  servicioNombre: "string",
  fecha: "string (dd/mm/yyyy)",
  hora: "string (HH:mm)",
  estado: "string", // "programada", "completada", "cancelada"
  terapeutaUid: "string", // ID del usuario propietario
  fechaCreacion: Timestamp
}
```

---

## üîí **Sistema de Seguridad Multi-Usuario**

### **Principio de Separaci√≥n**
- Cada usuario solo ve SUS datos
- Filtrado por `terapeutaUid` o `estudioUid`
- Queries siempre incluyen `.where('terapeutaUid', isEqualTo: currentUser.uid)`

### **Implementaci√≥n**
```dart
// Ejemplo en todas las consultas
FirebaseFirestore.instance
  .collection('clientes')
  .where('terapeutaUid', isEqualTo: FirebaseAuth.instance.currentUser?.uid)
  .where('activo', isEqualTo: true)
  .snapshots()
```

---

## üì± **Pantallas y Funcionalidades**

### **1. SplashScreen**
- **Archivo:** `splash_screen.dart`
- **Funci√≥n:** Verificaci√≥n de autenticaci√≥n autom√°tica
- **Duraci√≥n:** 3 segundos con logo
- **Navegaci√≥n:** ‚Üí PantallaInicio o PantallaMenuTerapeuta

### **2. PantallaInicio**
- **Archivo:** `pantalla_inicio.dart` 
- **Funci√≥n:** Pantalla de bienvenida
- **Elementos:** Logo, botones "Entrar como Profesional" y "Registrarse"

### **3. PantallaLogin**
- **Archivo:** `pantalla_login.dart`
- **Funci√≥n:** Autenticaci√≥n de usuarios
- **Campos:** Email, contrase√±a
- **Validaciones:** Email v√°lido, contrase√±a m√≠nima
- **Extras:** "Olvid√© mi contrase√±a", persistencia de sesi√≥n

### **4. PantallaRegistro** 
- **Archivo:** `pantalla_registro.dart`
- **Funci√≥n:** Registro de nuevos usuarios
- **Campos:** Email, contrase√±a, confirmaci√≥n
- **Validaciones:** Email √∫nico, contrase√±as coincidentes

### **5. PantallaMenuTerapeuta**
- **Archivo:** `pantalla_menu_terapeuta.dart`
- **Funci√≥n:** Men√∫ principal (dashboard)
- **Opciones:** 
  - Ver Clientes
  - Agregar Cliente  
  - Agendar Cita
  - Ver Citas
  - Gestionar Equipo
  - Gestionar Servicios
  - Cerrar Sesi√≥n

### **6. Gesti√≥n de Clientes**

#### **PantallaVerClientes**
- **Archivo:** `pantalla_ver_clientes.dart`
- **Funci√≥n:** Lista de clientes con b√∫squeda
- **Caracter√≠sticas:**
  - StreamBuilder para datos en tiempo real
  - Barra de b√∫squeda por nombre
  - Cards con informaci√≥n del cliente
  - Botones editar/eliminar
  - FloatingActionButton para agregar

#### **PantallaAgregarCliente**
- **Archivo:** `pantalla_agregar_cliente.dart`
- **Funci√≥n:** Formulario de nuevo cliente
- **Campos:** Nombre, tel√©fono, email, fecha de cumplea√±os
- **Extras:** Selecci√≥n de foto, validaciones

#### **PantallaEditarCliente**
- **Archivo:** `pantalla_editar_cliente.dart`
- **Funci√≥n:** Edici√≥n de cliente existente
- **Caracter√≠sticas:** Formulario pre-poblado, actualizaci√≥n de foto

### **7. Gesti√≥n de Citas**

#### **PantallaAgendarCita**
- **Archivo:** `pantalla_agendar_cita.dart`
- **Funci√≥n:** Crear nueva cita
- **Campos:** Cliente (dropdown), empleado (dropdown), servicio (dropdown), fecha, hora, estado
- **Validaciones:** Campos obligatorios, formato de fecha/hora

#### **PantallaVerCitas**
- **Archivo:** `pantalla_ver_citas.dart`
- **Funci√≥n:** Vista organizada de citas
- **Caracter√≠sticas:**
  - Agrupaci√≥n por estado (Programadas, Completadas, Canceladas)
  - Formato de fecha profesional con intl
  - Cards informativos con todos los detalles
  - Colores diferenciados por estado

### **8. Gesti√≥n de Equipo**

#### **PantallaGestionarTerapeutas**
- **Archivo:** `pantalla_gestionar_terapeutas.dart`  
- **Funci√≥n:** CRUD completo de empleados
- **Caracter√≠sticas:**
  - Formulario para agregar empleado
  - Lista en tiempo real con StreamBuilder
  - Editar empleado (dialog)
  - Eliminar con confirmaci√≥n
  - Validaci√≥n de nombres √∫nicos
  - Ordenamiento por fecha de creaci√≥n

### **9. Gesti√≥n de Servicios**

#### **PantallaGestionarServicios**
- **Archivo:** `pantalla_gestionar_servicios.dart`
- **Funci√≥n:** CRUD completo de servicios
- **Caracter√≠sticas:**
  - Formulario para agregar servicio
  - Lista en tiempo real
  - Editar servicio (dialog)
  - Eliminar con confirmaci√≥n
  - Migraci√≥n autom√°tica de datos existentes

---

## üéØ **Modelos de Datos**

### **Cliente (cliente.dart)**
```dart
class Cliente {
  final String id;
  final String nombre;
  final String telefono;
  final String email;
  final String fechaCumpleanos;
  final String terapeutaUid;
  final DateTime fechaCreacion;
  final bool activo;
  final String? fotoPath;
  
  // M√©todos: fromMap(), toMap(), copyWith()
}
```

### **Cita (cita.dart)**
```dart
class Cita {
  final String id;
  final String clienteNombre;
  final String clienteTelefono;
  final String terapeutaNombre;
  final String servicioNombre;
  final String fecha;
  final String hora;
  final String estado;
  final String terapeutaUid;
  final DateTime fechaCreacion;
  
  // M√©todos: fromMap(), toMap()
}
```

### **Servicio (servicio.dart)**
```dart
class Servicio {
  final String id;
  final String nombre;
  final String estudioUid;
  final DateTime fechaCreacion;
  final bool activo;
  
  // M√©todos: fromMap(), toMap()
}
```

---

## üîÑ **Funcionalidades Especiales**

### **1. Sistema de Clasificaci√≥n por Estrellas ‚≠ê**
- **Niveles:** 0-3 estrellas por cliente
- **Clasificaciones:** Regular, Frecuente, Premium, VIP
- **Colores:** Gris, Azul, Morado, Dorado
- **Persistencia:** Campo `nivelCliente` en Firestore
- **Edici√≥n:** Selector visual en formulario de edici√≥n

### **2. Sistema de Cumplea√±os üéÇ**
- **Detecci√≥n:** Autom√°tica al hacer login
- **Notificaci√≥n:** Dialog visual con lista de cumplea√±eros
- **Informaci√≥n:** Nombre, edad actual, acciones de contacto
- **Persistencia:** Verificaci√≥n diaria autom√°tica

### **3. Sistema de Papelera üóëÔ∏è**
- **Soft Delete:** Los clientes no se eliminan, se marcan como eliminados
- **Restauraci√≥n:** Posibilidad de recuperar clientes eliminados
- **Estad√≠sticas:** Contador de clientes en papelera
- **Limpieza:** Eliminaci√≥n permanente opcional

### **4. B√∫squeda en Tiempo Real üîç**
- **Filtrado:** Por nombre, email y tel√©fono
- **Instant√°neo:** Resultados mientras se escribe
- **Highlight:** Resaltado de coincidencias
- **Performance:** Optimizado para grandes listas

### **5. Gesti√≥n de Fotos**
- **Selecci√≥n:** image_picker
- **Almacenamiento:** Local en directorio de la app
- **Visualizaci√≥n:** CircleAvatar con FileImage
- **Fallback:** Icono por defecto si no hay foto

### **6. Persistencia de Sesi√≥n**
- **Servicio:** SharedPreferences
- **Datos guardados:** Email y contrase√±a (encriptados)
- **Verificaci√≥n:** Autom√°tica en SplashScreen
- **Limpieza:** Al cerrar sesi√≥n

### **7. Validaciones**
- **Email:** Regex pattern + Firebase validation
- **Tel√©fono:** Solo n√∫meros, m√≠nimo 10 d√≠gitos
- **Fechas:** Formato dd/mm/yyyy
- **Nombres:** No vac√≠os, sin caracteres especiales
- **Unicidad:** Validaci√≥n en tiempo real con Firebase

### **4. Manejo de Estados**
- **Loading:** CircularProgressIndicator durante operaciones async
- **Errores:** SnackBar con mensajes descriptivos
- **√âxito:** SnackBar de confirmaci√≥n
- **Vac√≠o:** Mensajes y iconos informativos

---

## üé® **Patrones de UI Utilizados**

### **Cards Informativos**
```dart
Card(
  child: ListTile(
    leading: CircleAvatar(), // Foto o icono
    title: Text(), // Nombre principal
    subtitle: Column(), // Informaci√≥n adicional
    trailing: PopupMenuButton(), // Acciones
  ),
)
```

### **Formularios Consistentes**
```dart
Form(
  key: _formKey,
  child: Column(
    children: [
      TextFormField(validator: validate),
      ElevatedButton(onPressed: submit),
    ],
  ),
)
```

### **Navegaci√≥n Est√°ndar**
```dart
Navigator.push(context, 
  MaterialPageRoute(builder: (context) => NextScreen())
);
```

---

## üìä **Optimizaciones Implementadas**

### **Firebase**
- Queries optimizadas con √≠ndices simples
- Filtrado por usuario para seguridad
- StreamBuilder para datos en tiempo real
- Paginaci√≥n impl√≠cita con l√≠mites

### **Performance**
- Lazy loading de im√°genes
- Validaci√≥n de campos en tiempo real
- Cach√© local con SharedPreferences
- Tree-shaking de iconos (reducci√≥n 99.6%)

### **UX**
- Feedback inmediato en acciones
- Estados de carga visibles
- Validaciones preventivas
- Navegaci√≥n intuitiva

---

## üöÄ **Funcionalidades Listas para Producci√≥n**

‚úÖ **Sistema completo de autenticaci√≥n**
‚úÖ **CRUD completo para todas las entidades**
‚úÖ **Seguridad multi-usuario robusta**
‚úÖ **Interfaz profesional y consistente**
‚úÖ **Validaciones exhaustivas**
‚úÖ **Manejo de errores completo**
‚úÖ **Persistencia de datos**
‚úÖ **Optimizaci√≥n de rendimiento**
‚úÖ **Terminolog√≠a profesional gen√©rica**

---

## üîß **Comandos de Desarrollo**

### **Ejecutar en desarrollo**
```bash
flutter run
```

### **Compilar APK de producci√≥n**
```bash
flutter build apk --release
```

### **Limpiar proyecto**
```bash
flutter clean
flutter pub get
```

### **Resolver dependencias**
```bash
flutter pub get
```

---

## üìù **Notas Importantes para IAs**

### **Contexto de Uso**
- La app est√° COMPLETA y FUNCIONAL
- Todos los sistemas est√°n integrados y probados
- La arquitectura es escalable y mantenible
- Se puede usar como base para nuevas funcionalidades

### **Patrones de C√≥digo**
- Consistencia en nomenclatura (espa√±ol para UI, ingl√©s para c√≥digo)
- Separaci√≥n clara de responsabilidades
- Validaciones exhaustivas en formularios
- Manejo de estados con StatefulWidget

### **Consideraciones Especiales**
- Firebase configurado para multi-usuario
- Terminolog√≠a gen√©rica (no espec√≠fica de spas)
- Compatibilidad con datos existentes
- Sistema de migraci√≥n autom√°tica implementado

---

**Esta documentaci√≥n representa el estado ACTUAL y COMPLETO de la aplicaci√≥n W√§ Estudio v1.0 al 30 de Julio de 2025.**
